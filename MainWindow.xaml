<Window x:Class="ElectronicComponentStore.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Магазин электронных компонентов" Height="600" Width="900"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Заголовок -->
        <TextBlock Grid.Row="0" Text="{Binding CurrentView}" FontSize="16" FontWeight="Bold" 
                   Margin="10" HorizontalAlignment="Center"/>

        <!-- Основное содержимое -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Панель категорий -->
            <StackPanel Grid.Column="0" Background="#f0f0f0">
                <TextBlock Text="Категории" FontWeight="Bold" Margin="10,10,10,5"/>

                <Button Content="Все компоненты" Margin="10,5" Padding="10,5" 
                        Command="{Binding LoadComponentsCommand}"/>

                <ItemsControl ItemsSource="{Binding ComponentTypes}" Margin="10,0">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button Content="{Binding TypeName}" Margin="5,2" Padding="10,5"
                                    Command="{Binding DataContext.LoadComponentsByTypeCommand, 
                                             RelativeSource={RelativeSource AncestorType=Window}}"
                                    CommandParameter="{Binding TypeName}">
                                <Button.ToolTip>
                                    <TextBlock Text="{Binding Count, StringFormat='Количество: {0}'}"/>
                                </Button.ToolTip>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>

            <!-- Список компонентов -->
            <DataGrid Grid.Column="1" ItemsSource="{Binding Components}" 
                      SelectedItem="{Binding SelectedComponent}"
                      AutoGenerateColumns="False" CanUserAddRows="False"
                      Margin="10" IsReadOnly="True">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Название" Binding="{Binding Name}" Width="*">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="Foreground" Value="Blue"/>
                                <Setter Property="TextDecorations" Value="Underline"/>
                                <Setter Property="Cursor" Value="Hand"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Тип" Binding="{Binding Type}" Width="120"/>
                    <DataGridTextColumn Header="Ячейка" Binding="{Binding CellNumber}" Width="80"/>
                    <DataGridTextColumn Header="Количество" Binding="{Binding Quantity}" Width="80"/>
                    <DataGridTextColumn Header="Дата изменения" Binding="{Binding DateOfChanges, StringFormat=dd.MM.yyyy}" Width="100"/>
                    <DataGridTemplateColumn Header="Даташит" Width="100">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Datasheet}" 
                                           Foreground="Blue" TextDecorations="Underline"
                                           Cursor="Hand"
                                           ToolTip="Открыть даташит">
                                    <TextBlock.InputBindings>
                                        <MouseBinding MouseAction="LeftClick" 
                                                      Command="{Binding DataContext.OpenDatasheetCommand, 
                                                               RelativeSource={RelativeSource AncestorType=Window}}"/>
                                    </TextBlock.InputBindings>
                                </TextBlock>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>

                <DataGrid.InputBindings>
                    <MouseBinding MouseAction="LeftDoubleClick" 
                                  Command="{Binding ShowComponentDetailsCommand}"
                                  CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGrid}, Path=SelectedItem}"/>
                </DataGrid.InputBindings>
            </DataGrid>
        </Grid>

        <!-- Панель инструментов -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="10">
            <Button Content="Добавить" Command="{Binding AddComponentCommand}" 
                    Margin="5,0" Padding="10,5"/>
            <Button Content="Редактировать" Command="{Binding EditComponentCommand}" 
                    Margin="5,0" Padding="10,5"/>
            <Button Content="Удалить" Command="{Binding DeleteComponentCommand}" 
                    Margin="5,0" Padding="10,5"/>
        </StackPanel>
    </Grid>
</Window>